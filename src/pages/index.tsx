import { type NextPage } from "next";
import Head from "next/head";
import { useRef, useState } from "react";

import MapContainer from "../components/MapContainer/MapContainer";
import PropertyCard from "../components/PropertyCard";
import PropertyFilters from "../components/PropertyFilters";

import { trpc } from "../utils/trpc";

const Home: NextPage = () => {
  const properties = trpc.property.getAllProperties.useQuery();

  const [activeProperty, setActiveProperty] = useState<string>("");

  // const createProperty = trpc.property.propertyCreate.useMutation();
  // const createPropertyType = trpc.propertyType.propertyTypeCreate.useMutation();

  const handleClick = () => {
    // createProperty.mutate({
    //   location: { lat: -31.53576907382949, lng: -68.531095306108 },
    //   ambiences: 2,
    //   bathrooms: 1,
    //   address: "Plaza Laprida 567 oeste",
    //   typeId: "clbz7mo6n0003e7kowfcl1c3t",
    //   operation: "rent",
    //   price: 2700000,
    // });
    // createPropertyType.mutate({ name: "Departamento" });
  };

  return (
    <>
      <Head>
        <title>Paseo 360</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="px-2">
        <MapContainer
          properties={properties.data}
          setActiveProperty={setActiveProperty}
          activeProperty={activeProperty}
        />
        <section className="ml-auto w-3/5 pl-4 ">
          <PropertyFilters />
          <div className="grid grid-cols-2 gap-6">
            {!properties.isLoading &&
              properties?.data?.map((property) => (
                <PropertyCard
                  key={property.id}
                  property={property}
                  activeProperty={activeProperty}
                />
              ))}
          </div>
          <button onClick={handleClick}>CREAR PROPIEDAD</button>
        </section>
      </main>
    </>
  );
};

export default Home;
